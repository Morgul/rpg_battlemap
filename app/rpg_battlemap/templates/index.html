{% extends "base.html" %}

	{% block page_style %}
	<link type="text/css" href="/contrib/css/simplegrid.css" rel="stylesheet" />
	{% endblock %}

	{% block content %}
	{% if user %}
		<div class="grid grid-pad">

			<div class="col-1-3">
				<div class="content">
					<h1>Maps I'm participating In</h1>
					{% for map in member_of_maps %}<p>
						<a href="{{ map.url }}">{{ map.name }}</a>
					</p>{% empty %}<p>
						None (yet)
					</p>{% endfor %}
				</div>
			</div>

			<div class="col-1-3">
				<div class="content">
					<h1>Maps I Own</h1>
					{% for map in maps %}<p>
						<a href="{{ map.url }}">{{ map.name }}</a>
						<button data-mapurl="{{ map.url }}" data-role="map-delete">X</button>
					</p>{% empty %}<p>
						None (yet)
					</p>{% endfor %}
					<p>
						<form action="{{ map_create_url }}" id="newmap">
							<input name="mapname" placeholder="Map Name" />
							<input type="submit" name="New Map" value="New Map" />
						</form>
					</p>
				</div>
			</div>

			<div class="col-1-3">
				<div class="content">
					<h1>Characters I Own</h1>
					{% for character in characters %}<p>
						<a href="{{ character.url }}">{{ character.name }}</a>
						<button data-characterUrl="{{ character.url }}" data-role="character-delete">X</button>
					</p>{% empty %}<p>
						None (yet)
					</p>{% endfor %}
					<p>
						<form action="{{ character_create_url }}" id="newcharacter">
							<input name="charactername" placeholder="Character Name" />
							<input type="submit" name="New Character" value="New Character" />
						</form>
					</p>
				</div>
			</div>

		</div>
	{% else %}
		<a id="signinlink" href="javascript:void()" class="persona-button">
			<span>Sign in with your Email</span>
		</a>
	{% endif %}
	{% endblock %}
	
	{% block page_scripts %}
	<script type="text/javascript">
		/*$('form#newmap').submit(function(ev){
			var mapName = ev.target.mapname.value;
			var createUrl = ev.target.action;
			var defer = $.ajax({
				url: createUrl,
				type: 'put',
				data: JSON.stringify({
					name: mapName
				}),
				contentType: 'application/json'
			});
			defer.success(function(json, status, xhr){
				var mapLocation = xhr.getResponseHeader('Location');
				window.location.href = mapLocation;
				return true;
			});
			return false;
		});

		$('[data-role="map-delete"]').on('click', function(ev){
			var deleteUrl = ev.target.dataset.mapurl;
			var defer = $.ajax({
				url: deleteUrl,
				type: 'delete'
			});
			defer.success(function(){
				window.location.reload();
			});
		});

		$('form#newcharacter').submit(function(ev){
			var characterName = ev.target.charactername.value;
			var createUrl = ev.target.action;
			var defer = $.ajax({
				url: createUrl,
				type: 'put',
				data: JSON.stringify({
					name: characterName
				}),
				contentType: 'application/json'
			});
			defer.success(function(){
				window.location.reload();
			});
			return false;
		});

		$('[data-role="character-delete"]').on('click', function(ev){
			var deleteUrl = ev.target.dataset.characterurl;
			var defer = $.ajax({
				url: deleteUrl,
				type: 'delete'
			});
			defer.success(function(){
				window.location.reload();
			});
		});*/
	</script>
	{% endblock %}
{% comment %}
{# -*- vim: set ft=htmldjango: -- vim modeline -*- #}{% endcomment %}
