<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="/contrib/jquery.js"></script>
	<script type="text/javascript" src="/contrib/jquery-ui.min.js"></script>
	<script type="text/javascript" src="/contrib/jquery.tools.min.js"></script>
	<script type="text/javascript" src="/contrib/raphael-min.js"></script>
	<script type="text/javascript" src="/js/battlemap.js"></script>
	<link type="text/css" src="/css/base.css" rel="stylesheet" />
	<title>RPG Battle Map{% block title %}{% endblock %}</title>
	<style type="text/css" rel="/contrib/css/smoothness/jquery-ui.css"></style>
	<style type="text/css">
		#drawingBoard {
			height:70%;
			position:relative;
		}
		#canvasBoard {
			position:absolute;
			top:0;
			left:0;
			pointer-events: none;
		}
		#combatantList {
			list-style:none;
		}
		#combatantInfo {
		}
		#leftColumn {
			float:left;
			width:200px;
		}
		#rightColumn {
			margin-left:200px;
		}
	</style>
</head>
<body>
<div id="head">
<form action="/account/login/" method="post">
	<input name="openid" placeholder="{% trans "OpenID" %}" />
	<input type="submit" value="{% trans "Login" %}" />
</form>
</div>
<div id="main">
{% block content %}
	<div id="leftColumn">
		<div id="combatantInfo">
			<img object-property="image" display-attr="src" />
			<p object-property="color" display-attr="style" style-display="background-color"><span object-property="name">&nbsp;</span></p>
			<p>cell
				<span object-property="cellX">&nbsp;</span> X <span object-property="cellY">&nbsp;</span>
			</p>
		</div>
		<ul id="combatantList">
			<li>Combatant One</li>
			<li>Combatant Two</li>
		</ul>
	</div>
	<div id="rightColumn">
		<div id="drawingBoard">
			<canvas id="canvasBoard"></canvas>
		</div>
	</div>
</div>
<script type="text/javascript">
	$().ready(function(){
		window.battleMap = new BattleMap('drawingBoard', 'canvasBoard', {});
		function resizeBattleMap() {
			var headerHeight = $('#head').height();
			var guessheight = window.innerHeight - (headerHeight + 20) ;
			$('#drawingBoard').height(guessheight);
			var newHeight = $('#drawingBoard').height();
			var newWidth = $('#drawingBoard').width();
			$('#canvasBoard').attr("width", newWidth)
			$('#canvasBoard').attr("height", newHeight);
			window.battleMap.drawGrid();
		}

		$(window).resize(resizeBattleMap);

		$('#drawingBoard').mousewheel(function(ev, delta){
			if(isNaN(delta)){
				delta = ev.originalEvent.wheelDelta;
			}
			delta = delta / 100;
			battleMap.setZoom(battleMap.zoom + delta);
			return false;
		});

		resizeBattleMap();
		window.battleMap.drawGrid();
	});
</script>
{% endblock %}
</body>
